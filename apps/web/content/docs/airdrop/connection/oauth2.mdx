---
title: OAuth2 Connection
description: Airdrop configuration for OAuth2 authentication connections
---

## Installation

<BlockItem
  name="airdrop-connection-oauth2"
  description="Airdrop configuration for OAuth2 authentication connections"
/>

## Configuration

<RegistryBlock itemName="airdrop-connection-oauth2" />

## Overview

The OAuth2 Connection airdrop provides secure authentication using the OAuth2 authorization flow. This configuration supports the standard authorization code grant type with PKCE (Proof Key for Code Exchange) for enhanced security.

## Configuration Options

### Authentication

The OAuth2 connection requires the following configuration:

- **client_id**: OAuth2 client identifier
- **client_secret**: OAuth2 client secret
- **authorization_url**: Authorization endpoint URL
- **token_url**: Token endpoint URL
- **redirect_uri**: Redirect URI for authorization callback
- **scope**: OAuth2 scope (default: "read")

### Environment Variables

Set the following environment variables:

```bash
CLIENT_ID=your_oauth2_client_id
CLIENT_SECRET=your_oauth2_client_secret
AUTHORIZATION_URL=https://provider.com/oauth2/authorize
TOKEN_URL=https://provider.com/oauth2/token
REDIRECT_URI=https://yourapp.com/oauth2/callback
```

### OAuth2 Flow Configuration

The configuration supports:

- **Grant Type**: Authorization Code
- **Response Type**: Code
- **PKCE**: Enabled for enhanced security
- **State Parameter**: Required for CSRF protection
- **Automatic Token Refresh**: Enabled with 5-minute threshold

### Endpoints

The configuration includes the following endpoints:

- **authorize**: `/oauth2/authorize` - Authorization endpoint
- **token**: `/oauth2/token` - Token exchange endpoint
- **refresh**: `/oauth2/refresh` - Token refresh endpoint
- **revoke**: `/oauth2/revoke` - Token revocation endpoint
- **userinfo**: `/oauth2/userinfo` - User information endpoint

## Usage

After installation, the manifest file will be available at:

```
~/manifest.yml
```

### Example Configuration

```yaml
version: "2"
name: "OAuth2 Connection"
description: "Airdrop configuration for OAuth2 authentication connections"
type: "airdrop-connection"
auth_type: "oauth2"

connection:
  authentication:
    type: "oauth2"
    client_id: "${CLIENT_ID}"
    client_secret: "${CLIENT_SECRET}"
    grant_type: "authorization_code"
    scope: "read write"

  oauth2:
    authorization_url: "${AUTHORIZATION_URL}"
    token_url: "${TOKEN_URL}"
    redirect_uri: "${REDIRECT_URI}"
    response_type: "code"
    state_required: true
    pkce_enabled: true
```

## Token Management

The configuration includes automatic token management:

- **Secure Storage**: Tokens are stored securely
- **Auto Refresh**: Tokens are automatically refreshed before expiration
- **Refresh Margin**: 5-minute buffer before token expiration
- **Retry Logic**: Up to 3 retry attempts for failed operations

## Error Handling

The configuration includes comprehensive error handling with:

- Automatic retry on failure (max 3 attempts)
- Exponential backoff strategy
- Retry on specific HTTP status codes (408, 429, 5xx)
- OAuth2-specific error handling:
  - `invalid_client`: Check client credentials
  - `invalid_grant`: Authorization code may be expired
  - `invalid_scope`: Requested scope not available

## Security Best Practices

- Keep your client secret secure and never commit it to version control
- Use environment variables for sensitive configuration
- Enable PKCE for enhanced security (enabled by default)
- Use the state parameter for CSRF protection (required by default)
- Implement proper redirect URI validation
- Consider using short-lived tokens with automatic refresh
- Regularly rotate your client credentials

## OAuth2 Flow Steps

1. **Authorization Request**: User is redirected to authorization server
2. **User Consent**: User grants permission to your application
3. **Authorization Code**: Server redirects back with authorization code
4. **Token Exchange**: Application exchanges code for access token
5. **API Access**: Use access token to make authenticated API requests
6. **Token Refresh**: Automatically refresh tokens before expiration
